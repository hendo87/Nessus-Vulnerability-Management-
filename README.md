# Nessus-Vulnerability-Management-

<i>Vulnerability management is crucial for maintaining a strong cybersecurity posture by proactively identifying and addressing potential security weaknesses. By following a systematic approach involving discovery, assessment, remediation, verification, and continuous monitoring, organizations can significantly reduce their risk of cyber threats and enhance their overall security resilience. In this lab I run a credentialed scan on a outdated Windows vm with vulnerabilities. Then I remediate a few of the critical and high vulnerabilites.</i>


## Configure host for credentialed scan

<p>We need to allow our scanner to connect to the Windows registry to look for insecure configurations. A Windows registry is a database that stores configuration settings and options for the operating system and installed applications. It includes settings related to system hardware, installed software, user preferences, and other system configurations. For this reason the registry can be a prime target for attackers. Scanning helps identify any vulnerabilities or misconfigurations that could be exploited</p>

<br>

<li>Services > Remote Registry > turn on to Automatic</li>

<br>

![Screenshot (2)](https://github.com/user-attachments/assets/4a6cdd29-4d47-488e-a95f-18566e9daf03)

<br>

<p>Advanced sharing allows the scan to access and evaluate network shares and file systems that might be exposed over the network. This is important because vulnerabilities can exist in shared resources, and scanning them helps identify potential risks.</p>

<br>

<li>Advanced sharing > Enable file and printer sharing </li>

<br>

![Screenshot (3)](https://github.com/user-attachments/assets/669e1fb4-5074-4963-a77f-212a7d555bf6)

<br>

<p>Lowering User Access Control during a vulnerability scan can help ensure that the scan runs smoothly and covers all areas of the system. This reduces the number of prompts or interruptions that could occur during the scan.</p>

<br>

<li>User account control : Set to lowest control</li>

<br>
 
![Screenshot (4)](https://github.com/user-attachments/assets/eec76339-1e6c-44df-a361-2106923ea1d8)

<br>

<p>The LocalAccountTokenFilterPolicy setting is important when performing vulnerability scans, particularly on Windows environments. This policy affects how tokens for local accounts are handled by the system and can impact the ability of vulnerability scanners to access and evaluate certain aspects of the system. When set to 1, this policy causes the system to filter local account tokens, meaning that remote access requests made with local account credentials will have more restricted permissions.</p>

<br>

<li>Registry Edit > Local Machine > Software > Microsoft > Windows > Current Version > Policies > System</li>
<li>Create a DWORD > Name it : LocalAccountTokenFilterPolicy > Set hexidecimal value to 1</li>
<li>Reboot Computer</li>

<br>

![Screenshot (5)](https://github.com/user-attachments/assets/e21125a5-2e20-47ab-82cd-e93e3fd498ed)

<br>

<li>Go to Nessus > Basic Network Scan > Name : Windows 10 single host > Target : Input host machine IP address</li>

<br>

![Screenshot (81)](https://github.com/user-attachments/assets/9a9430ee-2af6-450d-8eb4-a84958119aea)

<br>

<p>A credentialed vulnerability scan is a type of security scan where Nessus is provided with valid login credentials for the systems being scanned. This approach allows the scan to perform a deeper and more thorough assessment of the system compared to non-credentialed scans.</p>

<br>

<li>Select Credential Scan : Input credentials for host > Save</li>

<br>

![Screenshot (82)](https://github.com/user-attachments/assets/709e10f4-fefc-4a55-9f7d-b3babce1cc76)

<br>

# Vulnerablities
<i>As you can see , after running the credentialed scan we have many critical and high vulnerabilites on our host. Lets dive into them and begin remediating the vulnerabilites</i>


<br>

![Screenshot (85)](https://github.com/user-attachments/assets/7cc8ccc8-2a05-41b5-abe4-4d08d482cd8e)

<br>

<li>From reading the description we can see that the Firefox browser is outdated. Outdated web browsers can create significant vulnerabilities in a system because they may lack crucial security patches, fail to support modern security practices, and be incompatible with contemporary web standards. Keeping browsers up to date is essential to mitigate these risks and protect against potential threats. We can either uninstall or choose to update the browser</li>

<br>

![Screenshot (84)](https://github.com/user-attachments/assets/e1b9b5bc-95de-4f26-8b15-55c4ca1f44b8)

<br>

<li>Uninstalling Firefox browser</li>

<br>



![Screenshot (6)](https://github.com/user-attachments/assets/b90928c4-c0da-468d-8cd5-0fb7e4a87ef5)


<br>


<i>Our next vulnerability is SMB signing. It looks like the signiture is not required on the SMB server. SMB signing (Server Message Block signing) is a security feature used to protect the integrity of data transmitted over the SMB protocol, which is commonly used for file sharing and network communication in Windows environments. When SMB signing is enabled, each SMB packet (message) sent over the network includes a cryptographic signature this validates the integrity of the data and verifies the identity of the sender, making it much harder for an attacker to successfully tamper with or intercept SMB communications.</i>

<br>

![Screenshot (86)](https://github.com/user-attachments/assets/013bf5fb-6859-4f91-8e98-68f214faa128)

<br>

<li>Local Securtiy Policy > Local Policies > Security Options > Microsoft Network Server Digitally sign communication > Enable</li>

<br>

![Screenshot (91)](https://github.com/user-attachments/assets/0262b386-1c3c-4aff-8695-88cd525686da)


<i>Our next vulnerability is that our SSL certificate cant be trusted. The X.509 certificates are a standard for public key infrastructure (PKI) used to secure communications over networks like the internet. They are often used in SSL/TLS protocols to ensure secure communication between clients and servers. When a server’s X.509 certificate can’t be trusted, it typically indicates that there is a problem with the certificate’s validation, such as issues with the issuing CA, expiration, domain mismatch, or incomplete trust chain. Addressing these issues generally involves updating or replacing the certificate, ensuring the correct CA is used, and properly configuring the certificate chain.</i>

<br>

![Screenshot (90)](https://github.com/user-attachments/assets/0058b584-747c-41a7-aaf1-825619e5427c)

<br>

<i>We will need a custom CA to resolve this, in this case we will generate a self-signed SSL certificate and then add it into nessus rules. Follow the below instruction to create self signed certificate for development purpose</i>
<p>Open powershell command as administrator</p>
<p>Run this command in powershell : New-SelfSignedCertificate -DnsName "example.com" -CertStoreLocation "Cert:\LocalMachine\My" -NotAfter (Get-Date).AddYears(1)
</p>


<li>-DnsName: Specifies the domain name for which the certificate is issued. Replace "example.com" with your domain or IP address.</li>
<li>-CertStoreLocation: Specifies where to store the certificate. In this case, it stores it in the personal certificate store of the local machine.</li>
<li>-NotAfter: Sets the expiration date for the certificate. This example sets it to one year from the current date.</li>

<br>

<p>To see thumbprint : Get-ChildItem -Path Cert:\LocalMachine\My</p>





